!function(){var e={initialized:!1,viewModel:{imageLoaded:{"./images/sample_1.jpg":!1,"./images/sample_2.jpg":!1,"./images/sample_3.jpg":!1,"./images/sample_4.jpg":!1,"./images/sample_5.jpg":!1,"./images/1080banyan_01_01.jpg":!1,"./images/1080banyan_01_02.jpg":!1,"./images/1080banyan_01_03.jpg":!1,"./images/1080banyan_01_04.jpg":!1,"./images/1080banyan_01_05.jpg":!1,"./images/1080banyan_01_06.jpg":!1,"./images/1080banyan_01_07.jpg":!1,"./images/1080banyan_02_01.jpg":!1,"./images/1080banyan_02_02.jpg":!1,"./images/1080banyan_02_03.jpg":!1},p2Images:[["./images/sample_1.jpg","./images/sample_2.jpg","./images/sample_3.jpg"],["./images/sample_4.jpg","./images/sample_5.jpg",""],["./images/sample_1.jpg","./images/sample_2.jpg","./images/sample_3.jpg"],["./images/sample_1.jpg","./images/sample_2.jpg","./images/sample_3.jpg"]],p3Images:[],p3ImagesNum:[7,3],showArrowUp:!1,showArrowDown:!1,currentPage:1,totalPages:2,pageScrollInterval:1,browser:null,os:null,scrollDone:!0,worksLinkActive:!1,seeImgDetail:!1,showDeleteIcon:!1,showLinkIcon:!1,currentImg:0,init:function(){this.initImgResource(),this.changeArrow(),this.detectBrowser(),this.bindScrollEvent(),this.bindResizeEvent()},bindResizeEvent:function(){var e=this,t=!1;tool.addEvent(window,"resize",function(){t&&clearTimeout(t),t=setTimeout(function(){e.currentPage=1,e.worksLinkActive=!1,e.changeArrow(),e.ajustHeaderWidth(),m.redraw()},100)})},ajustHeaderWidth:function(){var e=document.querySelector(".diext header");clientWidth=document.body.clientWidth;var t=16;"mac"===this.os&&(t=12),e.style.width=100*(1-t/clientWidth).toFixed(4)+"%"},initImgResource:function(){var e=0,t=this;this.p2Images.forEach(function(i,n){e=n*i.length,i.forEach(function(i,n){var o=e+n;t.p3Images[o]=[];for(var a=1;a<=t.p3ImagesNum[o];a++)t.p3Images[o].push("./images/1080banyan_"+(10>o?"0"+(o+1):o+1)+"_"+(10>a?"0"+a:a)+".jpg")}),e++})},bindScrollEvent:function(){var e=this;tool.registerMouseScrollEvent(function(t,i){var n=document.querySelectorAll("caption")[e.currentPage-1].scrollTop;0===n&&(i>0?e.previousPage():e.nextPage(e.isServer()),m.redraw())})},detectBrowser:function(){var e=navigator.userAgent;if(-1!==e.indexOf("MSIE")){var t=/MSIE\s*(\d\.[^;])+/g,i=t.exec(e);i&&(this.browser={name:"IE",version:i[1]})}-1!==e.toLowerCase().indexOf("windows")?this.os="windows":-1!==e.toLowerCase().indexOf("mac")&&(this.os="mac")},changeArrow:function(){1===this.currentPage?(this.showArrowUp=!0,this.showArrowDown=!1):this.currentPage===this.totalPages?(this.showArrowUp=!1,this.showArrowDown=!0):(this.showArrowUp=!0,this.showArrowDown=!0)},deleteImageDetail:function(){this.preImgControl(),this.paramControl(!1)},linkToOther:function(){},previousPage:function(){return this.currentPage<=1?void(this.worksLinkActive=!1):void this.scrollPage("up")},nextPage:function(e){this.currentPage>=this.totalPages||(this.scrollPage("down"),e&&this.lazyLoadImages("caption.p2",!0))},scrollPage:function(e){if(this.scrollDone&&!this.seeImgDetail){this.showArrowUp=!1,this.showArrowDown=!1,this.scrollDone=!1;var t=window.innerHeight,i=document.querySelectorAll("caption"),n=null,o=null;"down"===e?(n=i[this.currentPage-1],o=i[this.currentPage],"undefined"!=typeof $?($(n).animate({top:-t},1e3*this.pageScrollInterval),$(o).animate({top:0},1e3*this.pageScrollInterval)):(n.style.top=-t+"px",o.style.top="0px")):"up"===e&&(n=i[this.currentPage-1],o=i[this.currentPage-2],"undefined"!=typeof $?($(n).animate({top:t},1e3*this.pageScrollInterval),$(o).animate({top:0},1e3*this.pageScrollInterval)):(n.style.top=t+"px",o.style.top="0px")),this.domAnimation(n,"top"),this.domAnimation(o,"top");var a=this;setTimeout(function(){"down"===e?a.currentPage+=1:"up"===e&&(a.currentPage-=1),1===a.currentPage&&(a.worksLinkActive=!1),a.changeArrow(),a.scrollDone=!0,m.redraw()},1e3*this.pageScrollInterval)}},domAnimation:function(e,t){(!this.browser||"IE"===this.browser.name&&this.browser.version>9)&&(e.style.transition=t+" "+this.pageScrollInterval+"s",e.style["-moz-transition"]=t+" "+this.pageScrollInterval+"s",e.style["-webkit-transition"]=t+" "+this.pageScrollInterval+"s",e.style["-o-transition"]=t+" "+this.pageScrollInterval+"s")},lazyLoadImages:function(e,t){var i=document.querySelectorAll(e+" img[data-url]"),n=this,o=[];if(i.length>0){var a=[];[].slice.call(i,0,i.length).forEach(function(e){var i=e.getAttribute("data-url"),r=n.imageLoaded[i];"undefined"==typeof r||r||-1!==a.indexOf(i,0)||(o.push(n.loadImg(i,t)),a.push(i))})}return o},loadImg:function(e,t){var i=m.deferred(),n=new Image,o=this;return n.src=e,n.onload=function(){o.imageLoaded[e]=!0,t&&setTimeout(m.redraw,1e3*o.pageScrollInterval),i.resolve()},n.onerror=function(){console.log("Image url("+e+") load error!"),i.reject()},i.promise},preImgControl:function(e){this.currentImg=e||0,m.redraw(!0)},popImageDetail:function(e,t,i){if(i){this.preImgControl(e);var n=this;t?m.sync(this.lazyLoadImages(".img-detail")).then(function(){n.paramControl(!0),m.redraw()}):this.paramControl(!0)}},paramControl:function(e){var t=document.querySelector(".diext .img-detail"),i=this;e?(t.style.zIndex="766","undefined"!=typeof $?$(t).animate({opacity:1},1e3*this.pageScrollInterval):t.style.opacity=1,this.domAnimation(t,"opacity"),setTimeout(function(){t.scrollTop=0,i.ajustHeaderWidth()},10*this.pageScrollInterval)):(t.style.opacity=0,t.style.zIndex="744"),this.showArrowDown=!e,this.showArrowUp=!e,this.showDeleteIcon=e,this.showLinkIcon=e,this.seeImgDetail=e,e||this.changeArrow()},isServer:function(){var e=location.href;return-1!==e.indexOf("http")}},controller:function(){var t=e.viewModel;return t.init(),t},imageView:function(e,t,i,n){var o={},a=!1;return t?i&&!e.imageLoaded[t]?(a=!0,o["data-url"]=t):o.src=t:a=!0,o.config=function(e){{var t=e.parentNode;t.className}a||(t.style.height="auto",t.style.marginLeft="0")},m("div.img"+(a?".default":""),n,[a?m("span.loading","Loading"):"",m("img",o)])},view:function(t){var i=t.isServer();return[m("header"+(t.seeImgDetail?".white-bg":""),[m("div.left",[m("span.logo"),m("span.txt","DIEXT LAB")]),m("div.right",m("nav",[m("a"+(t.worksLinkActive&&t.scrollDone?".active":""),{onclick:function(){t.worksLinkActive=!0,t.nextPage.call(t,i)}},"WORKS"),m("a","ABOUT")])),t.showArrowDown?m("div.scrollDown",{onclick:t.previousPage.bind(t)},m("span.icon")):"",t.showDeleteIcon?m("div.deleteIcon",{onclick:t.deleteImageDetail.bind(t)},m("span.icon")):"",t.showLinkIcon?m("div.linkIcon",{onclick:t.linkToOther.bind(t)},m("span.icon")):"",m("div.clear")]),m("caption.p1",m("div.main",{onmousemove:function(e){var t=this.querySelector(".card"),i=-((window.innerWidth/2-e.pageX)/20),n=(window.innerHeight/2-e.pageY)/10;t.setAttribute("style","transform:rotateY("+i+"deg) rotateX("+n+"deg);-webkit-transform: rotateY("+i+"deg) rotateX("+n+"deg);-moz-transform: rotateY("+i+"deg) rotateX("+n+"deg)")}},m("div.card",[m("img.frame",{src:"./images/bigword.svg"}),m("img.john",{src:"./images/lines.svg"}),m("img.lower",{src:"./images/smallword.svg"})]))),m("caption.p2",t.p2Images.map(function(n,o){return m("div.row",n.map(function(a,r){return e.imageView(t,a,i,{onclick:t.popImageDetail.bind(t,o*n.length+r,i,!!a),height:"438",width:"640"})}))})),m("div.img-detail",[m("div.top"),m("div.main",t.p3Images[t.currentImg].map(function(n){return e.imageView(t,n,i)}))]),m("footer",[t.showArrowUp?m("div.scrollUp",{onclick:t.nextPage.bind(t,i)},m("span.icon")):""])]}};m.mount(document.querySelector(".diext"),e)}();