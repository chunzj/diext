!function(){function e(){var e=document.querySelector(".diext"),t=e.classList;tool.isPhone()?(t.add("diext-m"),t.remove("diext-p"),m.mount(e,o)):(t.add("diext-p"),t.remove("diext-m"),m.mount(e,n))}var t=[["./images/sample_1.jpg","./images/sample_2.jpg","./images/sample_3.jpg"],["./images/sample_4.jpg","./images/sample_5.jpg",""]],i={"./images/sample_1.jpg":!1,"./images/sample_2.jpg":!1,"./images/sample_3.jpg":!1,"./images/sample_4.jpg":!1,"./images/sample_5.jpg":!1,"./images/1080banyan_01_01.jpg":!1,"./images/1080banyan_01_02.jpg":!1,"./images/1080banyan_01_03.jpg":!1,"./images/1080banyan_01_04.jpg":!1,"./images/1080banyan_01_05.jpg":!1,"./images/1080banyan_01_06.jpg":!1,"./images/1080banyan_01_07.jpg":!1},n={initialized:!1,viewModel:{sizeImages:{"./images/1080banyan_01_01.jpg":{height:"342"},"./images/1080banyan_01_02.jpg":{height:"760"},"./images/1080banyan_01_03.jpg":{height:"1596"},"./images/1080banyan_01_04.jpg":{height:"699"},"./images/1080banyan_01_05.jpg":{height:"977"},"./images/1080banyan_01_06.jpg":{height:"658"},"./images/1080banyan_01_07.jpg":{height:"1447"}},p2Images:t,p3Images:[],p3ImagesNum:[7],showArrowUp:!1,showArrowDown:!1,currentPage:1,totalPages:2,pageScrollInterval:1,browser:null,os:null,scrollDone:!0,worksLinkActive:!1,aboutLinkActive:!1,seeImgDetail:!1,showDeleteIcon:!1,showLinkIcon:!1,currentImg:0,init:function(){this.initImgResource(),this.detectBrowser(),tool.isPhone()||(this.changeArrow(),this.bindScrollEvent(),this.bindResizeEvent())},showCaptions:function(e){var t=document.querySelectorAll(".diext caption");[].slice.call(t,0,t.length).forEach(function(t){t.style.opacity=e?1:0})},bindResizeEvent:function(){var e=this,t=!1;tool.addEvent(window,"resize",function(){if(!tool.isPhone()){var i=null;i||(i=document.querySelector(".diext header")),e.showCaptions(!1),t&&(clearTimeout(t),t=null),i&&(t=setTimeout(function(){e.showCaptions(!0),e.currentPage=1,e.worksLinkActive=!1,e.aboutLinkActive=!1,e.changeArrow(),e.adjustHeaderWidth(i),m.redraw()},100))}})},adjustHeaderWidth:function(e){var t=window.innerWidth,i=16;"mac"===this.os&&(i=12),e.style.width=100*(1-i/t).toFixed(4)+"%"},initImgResource:function(){var e=0,t=this;this.p2Images.forEach(function(i,n){e=n*i.length,i.forEach(function(i,n){var o=e+n;t.p3Images[o]=[];for(var a=1;a<=t.p3ImagesNum[o];a++)t.p3Images[o].push("./images/1080banyan_"+(10>o?"0"+(o+1):o+1)+"_"+(10>a?"0"+a:a)+".jpg")}),e++})},bindScrollEvent:function(){var e=this;tool.registerMouseScrollEvent(function(t,i){if(!tool.isPhone()){var n=document.querySelectorAll("caption")[e.currentPage-1].scrollTop;0===n&&(i>0?e.previousPage():e.nextPage(),m.redraw())}})},detectBrowser:function(){var e=navigator.userAgent;if(-1!==e.indexOf("MSIE")){var t=/MSIE\s*(\d\.[^;])+/g,i=t.exec(e);i&&(this.browser={name:"IE",version:i[1]})}-1!==e.toLowerCase().indexOf("windows")?this.os="windows":-1!==e.toLowerCase().indexOf("mac")&&(this.os="mac")},changeArrow:function(){1===this.currentPage?(this.showArrowUp=!0,this.showArrowDown=!1):this.currentPage===this.totalPages?(this.showArrowUp=!1,this.showArrowDown=!0):(this.showArrowUp=!0,this.showArrowDown=!0)},deleteImageDetail:function(){this.preImgControl(),this.paramControl(!1),this.aboutLinkActive=!1,this.showDeleteIcon=!1,this.showLinkIcon=!1,m.redraw(!0)},linkToOther:function(){},previousPage:function(){return this.currentPage<=1?void(this.worksLinkActive=!1):void this.scrollPage("up")},nextPage:function(){this.currentPage>=this.totalPages||(this.worksLinkActive=!0,this.scrollPage("down"))},scrollPage:function(e){if(this.scrollDone&&!this.seeImgDetail){this.showArrowUp=!1,this.showArrowDown=!1,this.scrollDone=!1;var t=window.innerHeight,i=document.querySelectorAll("caption"),n=null,o=null;"down"===e?(n=i[this.currentPage-1],o=i[this.currentPage],"undefined"!=typeof $?($(n).animate({top:-t},1e3*this.pageScrollInterval),$(o).animate({top:0},1e3*this.pageScrollInterval)):(n.style.top=-t+"px",o.style.top="0px")):"up"===e&&(n=i[this.currentPage-1],o=i[this.currentPage-2],"undefined"!=typeof $?($(n).animate({top:t},1e3*this.pageScrollInterval),$(o).animate({top:0},1e3*this.pageScrollInterval)):(n.style.top=t+"px",o.style.top="0px")),this.domAnimation(n,"top"),this.domAnimation(o,"top");var a=this;setTimeout(function(){"down"===e?a.currentPage+=1:"up"===e&&(a.currentPage-=1),1===a.currentPage&&(a.worksLinkActive=!1),a.changeArrow(),a.scrollDone=!0,"down"===e&&a.lazyLoadImages("caption.p2",!0),m.redraw()},1e3*this.pageScrollInterval)}},domAnimation:function(e,t,i,n){"undefined"==typeof n&&(n=!0),2===arguments.length?"string"==typeof arguments[1]?(t=arguments[1],i=this.pageScrollInterval):"number"==typeof arguments[1]&&(i=arguments[1],t="all"):1===arguments.length&&(t="all",i=this.pageScrollInterval),(!n||!this.browser||"IE"===this.browser.name&&this.browser.version>9)&&(e.style.transition=t+" "+i+"s",e.style["-moz-transition"]=t+" "+i+"s",e.style["-webkit-transition"]=t+" "+i+"s",e.style["-o-transition"]=t+" "+i+"s")},lazyLoadImages:function(e,t){var n=document.querySelectorAll(e+" img[data-url]"),o=this,a=[];if(n.length>0){var r=[],s=m.deferred();[].slice.call(n,0,n.length).forEach(function(e){var n=e.getAttribute("data-url"),l=i[n];return a.push(s.promise),"undefined"==typeof l||l||-1!==r.indexOf(n,0)?void s.resolve():(o.loadImg(n,s,t),void r.push(n))})}return a},loadImg:function(e,t,n){var o=new Image,a=this;o.src=e,o.onload=function(){i[e]=!0,n&&setTimeout(m.redraw,1e3*a.pageScrollInterval),t.resolve()},o.onerror=function(){console.log("Image url("+e+") load error!"),t.reject()}},preImgControl:function(e){this.currentImg=e||0,m.redraw(!0)},popImageDetail:function(e,t,i){if(t){i?(this.preImgControl(e),m.sync(this.lazyLoadImages(".img-detail",!0))):this.aboutLinkActive=!0,this.paramControl(!0),m.redraw(!0)}},paramControl:function(e){var t=document.querySelector(".diext-p .img-detail");e?(t.style.zIndex="766","undefined"!=typeof $?$(t).animate({opacity:1},1e3*this.pageScrollInterval):t.style.opacity=1,this.domAnimation(t,"opacity"),setTimeout(function(){t.scrollTop=0},10*this.pageScrollInterval)):(t.style.opacity=0,t.style.zIndex="744"),this.showArrowDown=!e,this.showArrowUp=!e,this.showDeleteIcon=e,this.showLinkIcon=e,this.seeImgDetail=e,e||this.changeArrow()},backToMain:function(){this.deleteImageDetail(),this.previousPage()},imageScale:function(e,t,i,n){if(i&&n){var o=1.01,a=1,r=1;t?(o=1.2,a=1.2,r=1.2,e.style.zIndex=999):e.style.zIndex="inherit",e.style.transform="scale("+o+","+a+")",e.style["-moz-transform"]="scale("+o+","+a+")",e.style["-webkit-transform"]="scale("+o+","+a+")",e.style["-o-transform"]="scale("+o+","+a+")",this.domAnimation(e,1.5)}},bindScaleEvent:function(e,t,i){if(!t.bindEvent){var n=this;t.bindEvent=!0,t.onmouseover=function(){n.imageScale.call(n,this,!0,!!e,i)},t.onmouseout=function(){n.imageScale.call(n,this,!1,!!e,i)}}}},controller:function(){var e=n.viewModel;return e.init(),e},imageView:function(e,t,n,o){var a="./images/balckline.jpg",r=!0,s={};return t&&i[t]&&(a=t,r=!1),s.src=a,t&&r&&(s["data-url"]=t),s.config=function(i){var n=i.parentNode;r||2===e.currentPage&&("undefined"!=typeof $&&$(i).animate({opacity:1},1e3*e.pageScrollInterval),setTimeout(function(){var a=n.querySelector(".loading");a&&(a.style.display="none"),i.style.opacity=1,e.bindScaleEvent.call(e,t,i,o)},1e3*e.pageScrollInterval),e.domAnimation(i,"opacity"))},m("div.img"+(r?".default":""),n,[m("span.loading","Loading"),m("img",s)])},view:function(e){var t=e.seeImgDetail||2===e.currentPage;return[m("header"+(t?".white-bg":""),{config:function(i){t&&e.adjustHeaderWidth.call(e,i)}},[m("div.left",[m("span.logo",{onclick:e.backToMain.bind(e)}),m("span.txt",{onclick:e.backToMain.bind(e)},"DIEXT LAB")]),m("div.right",m("nav",[m("a"+(e.worksLinkActive&&e.scrollDone?".active":""),{onclick:function(){e.worksLinkActive=!0,e.nextPage.call(e)}},"WORKS"),m("a"+(e.aboutLinkActive?".active":""),{onclick:e.popImageDetail.bind(e,null,!0,!1)},"ABOUT")])),e.showArrowDown?m("div.scrollDown",{onclick:e.previousPage.bind(e)},m("span.icon")):"",e.showDeleteIcon?m("div.deleteIcon",{onclick:e.deleteImageDetail.bind(e)},m("span.icon")):"","",m("div.clear")]),m("caption.p1",m("div.main",{onmousemove:function(e){var t=this.querySelector(".card"),i=-((window.innerWidth/2-e.pageX)/20),n=(window.innerHeight/2-e.pageY)/10;t.setAttribute("style","transform:rotateY("+i+"deg) rotateX("+n+"deg);-webkit-transform: rotateY("+i+"deg) rotateX("+n+"deg);-moz-transform: rotateY("+i+"deg) rotateX("+n+"deg)")}},m("div.card",[m("img.frame",{src:"./images/bigword.svg"}),m("img.john",{src:"./images/lines.svg"}),m("img.lower",{src:"./images/smallword.svg"})]))),m("caption.p2",e.p2Images.map(function(t,i){return m("div.row",t.map(function(o,a){return n.imageView(e,o,{onclick:e.popImageDetail.bind(e,i*t.length+a,!!o,!0),height:"438",width:"640",scale:"0.333333"},!0)}))})),m("div.img-detail",e.aboutLinkActive?m("div.main.about",[m("h3","About DIEXT"),m("p.desc","DIEXT是一家互联网设计公司，创新与创意是DIEXT设计最核心的竞争力。同时在用户体验方面积累了多年的经验，为客户打造充满美而惊喜的产品体验与服务。我们的业务范围以界面为源点，衍生出用户体验设计、UI视觉设计、营销设计等，覆盖在流行的各种平台"),m("p.contact",[m("span","合作或咨询，请发邮件至  "),m("a",{href:"mailto:diecxters@foxmail.com"},m("strong","diecxters@foxmail.com"))])]):m("div.main",e.p3Images[e.currentImg].map(function(t){return n.imageView(e,t,{height:e.sizeImages[t].height,width:e.sizeImages[t].width||"1080",scale:"0.5"},!1)}))),m("footer",[e.showArrowUp?m("div.scrollUp",{onclick:e.nextPage.bind(e)},m("span.icon")):""])]}},o={isInitialized:!1,init:function(){var e={},t=null;tool.addEvent(window,"scroll",function(){if(o.viewModel.enableScroll){var n=document.querySelector("body").scrollTop,a=window.innerHeight,r=document.querySelectorAll(".diext-m img[data-url]");[].slice.call(r,0,r.length).forEach(function(o){var r=o.getAttribute("data-url");if(!e[r]&&!i[r]){var s=o.parentNode,l=s.offsetTop;n+a>l+50&&(e[r]=!0,t=new Image,t.src=r,t.onload=function(){i[r]=!0,s.querySelector(".loading").style.display="none",m.redraw(),console.log(r+"loaded")},t.onerror=function(){console.log("Image url("+r+") load error!")})}})}}),tool.addEvent(window,"resize",function(){if(tool.isPhone()){var e=o.viewModel;e.enableScroll=!0,e.activeWorks=!1,e.activeAbout=!1,e.currentThumb=-1}})},viewModel:{p2Images:t,currentThumb:-1,enableScroll:!0,activeWorks:!1,activeAbout:!1,backToMain:function(){this.activeWorks=!1,location.hash="main"},linkToAbout:function(){this.activeWorks=!0,this.activeAbout&&(this.activeAbout=!1,this.popImageDetail(!1,-1)),location.hash="#thumb"},popImageDetail:function(e,t){var i=document.querySelector(".diext-m .img-detail");e?(this.activeAbout=!0,this.enableScroll=!1,this.showDetail(!0),i.style.zIndex="120",i.style.opacity=1,n.viewModel.domAnimation.call(n.viewModel,i,"opacity"),this.adjustDetailHeight()):(this.activeAbout=!1,this.enableScroll=!0,this.showDetail(!1),i.style.zIndex="100",i.style.opacity=0),this.currentThumb=t},adjustDetailHeight:function(){-1===this.currentThumb&&(document.querySelector(".diext-m .img-detail").style.height=window.innerHeight+"px")},showDetail:function(e){var t=document.getElementById("main"),i=document.getElementById("thumb");t.style.display=e?"none":"block",i.style.display=e?"none":"block"}},controller:function(){return o.isInitialized||o.init(),o.viewModel},view:function(e){return[m("div#main.main",[m("header",[m("div.left.logo",m("span.text","DIEXT LAB")),m("nav.right",[m("a"+(e.activeWorks?".active":""),{href:"#thumb"},"WORKS"),m("a"+(e.activeAbout?".active":""),{onclick:e.popImageDetail.bind(e,!0,-1)},"ABOUT")]),m("di.clear")]),m("div.content",m("div.imgs",[m("img.target",{src:"./images/target.png"}),m("img.desc",{src:"./images/desc.png"})]))]),m("div#thumb.thumb",[m("div.title",{onclick:e.backToMain.bind(e)},"WORKS"),m("div.content",e.p2Images.map(function(e){return e.map(function(e){var t="./images/balckline.jpg",n=!0,o={};return e&&i[e]&&(t=e,n=!1),o.src=t,e&&n&&(o["data-url"]=e),m("div.img"+(n?".default":""),[n?m("span.loading","Loading"):"",m("img",o)])})}))]),m("div.img-detail",[m("header",[m("div.left.logo",m("span.text","DIEXT LAB")),m("div.left.delete-icon",{onclick:e.popImageDetail.bind(e,!1,-1)},m("span.icon")),m("nav.right",[m("a"+(e.activeWorks?".active":""),{onclick:e.linkToAbout.bind(e)},"WORKS"),m("a"+(e.activeAbout?".active":""),{onclick:e.popImageDetail.bind(e,!0,-1)},"ABOUT")]),m("di.clear")]),m("div.content"+(-1!==e.currentThumb?".detail":".about"),-1!==e.currentThumb?"":[m("h3","About DIEXT"),m("p.desc","DIEXT是一家互联网设计公司，创新与创意是DIEXT设计最核心的竞争力。同时在用户体验方面积累了多年的经验，为客户打造充满美而惊喜的产品体验与服务。我们的业务范围以界面为源点，衍生出用户体验设计、UI视觉设计、营销设计等，覆盖在流行的各种平台"),m("p.contact",[m("span","合作或咨询，请发邮件至  "),m("a",{href:"mailto:diecxters@foxmail.com"},m("strong","diecxters@foxmail.com"))])])])]}};e(),tool.addEvent(window,"resize",function(){e()})}();