!function(){function e(){var e=document.querySelector(".diext"),t=e.classList;tool.isPhone()?(t.add("diext-m"),t.remove("diext-p"),m.mount(e,o)):(t.add("diext-p"),t.remove("diext-m"),m.mount(e,a))}var t=[["./images/sample_1.jpg","./images/sample_2.jpg","./images/sample_3.jpg"],["./images/sample_4.jpg","./images/sample_5.jpg",""]],i={"./images/sample_1.jpg":"","./images/sample_2.jpg":"guogan","./images/sample_3.jpg":"","./images/sample_4.jpg":"","./images/sample_5.jpg":"banyan"},n={"./images/sample_1.jpg":!1,"./images/sample_2.jpg":!1,"./images/sample_3.jpg":!1,"./images/sample_4.jpg":!1,"./images/sample_5.jpg":!1,"./images/banyan_01.jpg":!1,"./images/banyan_02.jpg":!1,"./images/banyan_03.jpg":!1,"./images/banyan_04.jpg":!1,"./images/banyan_05.jpg":!1,"./images/banyan_06.jpg":!1,"./images/banyan_07.jpg":!1,"./images/guogan_01.jpg":!1,"./images/guogan_02.jpg":!1,"./images/guogan_03.jpg":!1,"./images/guogan_04.jpg":!1,"./images/guogan_05.jpg":!1,"./images/guogan_06.jpg":!1},a={initialized:!1,viewModel:{sizeImages:{"./images/banyan_01.jpg":{height:"342"},"./images/banyan_02.jpg":{height:"760"},"./images/banyan_03.jpg":{height:"1596"},"./images/banyan_04.jpg":{height:"699"},"./images/banyan_05.jpg":{height:"977"},"./images/banyan_06.jpg":{height:"658"},"./images/banyan_07.jpg":{height:"1447"},"./images/guogan_01.jpg":{height:"996"},"./images/guogan_02.jpg":{height:"896"},"./images/guogan_03.jpg":{height:"785"},"./images/guogan_04.jpg":{height:"1096"},"./images/guogan_05.jpg":{height:"720"},"./images/guogan_06.jpg":{height:"843"}},p2Images:t,p3Images:[],p3ImagesNum:[0,6,0,0,7],showArrowUp:!1,showArrowDown:!1,currentPage:1,totalPages:2,pageScrollInterval:1,browser:null,os:null,scrollDone:!0,worksLinkActive:!1,aboutLinkActive:!1,seeImgDetail:!1,showDeleteIcon:!1,showLinkIcon:!1,currentImg:0,init:function(){this.initImgResource(),this.detectBrowser(),tool.isPhone()||(this.changeArrow(),this.bindScrollEvent(),this.bindResizeEvent())},showCaptions:function(e){var t=document.querySelectorAll(".diext caption");[].slice.call(t,0,t.length).forEach(function(t){t.style.opacity=e?1:0})},bindResizeEvent:function(){var e=this,t=!1;tool.addEvent(window,"resize",function(){if(!tool.isPhone()){var i=null;i||(i=document.querySelector(".diext header")),e.showCaptions(!1),t&&(clearTimeout(t),t=null),i&&(t=setTimeout(function(){e.showCaptions(!0),e.currentPage=1,e.worksLinkActive=!1,e.aboutLinkActive=!1,e.showDeleteIcon=!1,e.changeArrow(),e.adjustHeaderWidth(i),m.redraw()},100))}})},adjustHeaderWidth:function(e){var t=window.innerWidth,i=16;"mac"===this.os&&(i=12),e.style.width=100*(1-i/t).toFixed(4)+"%"},initImgResource:function(){var e=0,t=this;this.p2Images.forEach(function(n,a){e=a*n.length,n.forEach(function(n,a){var o=i[n],r=e+a;if(t.p3Images[r]=[],o)for(var s=1;s<=t.p3ImagesNum[r];s++)t.p3Images[r].push("./images/"+o+"_"+(10>s?"0"+s:s)+".jpg")}),e++})},bindScrollEvent:function(){var e=this;tool.registerMouseScrollEvent(function(t,i){if(!tool.isPhone()){var n=document.querySelectorAll("caption")[e.currentPage-1].scrollTop;0===n&&(i>0?e.previousPage():e.nextPage(),m.redraw())}})},detectBrowser:function(){var e=navigator.userAgent;if(-1!==e.indexOf("MSIE")){var t=/MSIE\s*(\d\.[^;])+/g,i=t.exec(e);i&&(this.browser={name:"IE",version:i[1]})}-1!==e.toLowerCase().indexOf("windows")?this.os="windows":-1!==e.toLowerCase().indexOf("mac")&&(this.os="mac")},changeArrow:function(){1===this.currentPage?(this.showArrowUp=!0,this.showArrowDown=!1):this.currentPage===this.totalPages?(this.showArrowUp=!1,this.showArrowDown=!0):(this.showArrowUp=!0,this.showArrowDown=!0)},deleteImageDetail:function(){this.preImgControl(),this.paramControl(!1),this.aboutLinkActive=!1,this.showDeleteIcon=!1,this.showLinkIcon=!1,m.redraw(!0)},linkToOther:function(){},previousPage:function(){return this.currentPage<=1?void(this.worksLinkActive=!1):void this.scrollPage("up")},nextPage:function(){this.currentPage>=this.totalPages||(this.worksLinkActive=!0,this.scrollPage("down"))},scrollPage:function(e){if(this.scrollDone&&!this.seeImgDetail){this.showArrowUp=!1,this.showArrowDown=!1,this.scrollDone=!1;var t=window.innerHeight,i=document.querySelectorAll("caption"),n=null,a=null;"down"===e?(n=i[this.currentPage-1],a=i[this.currentPage],"undefined"!=typeof $?($(n).animate({top:-t},1e3*this.pageScrollInterval),$(a).animate({top:0},1e3*this.pageScrollInterval)):(n.style.top=-t+"px",a.style.top="0px")):"up"===e&&(n=i[this.currentPage-1],a=i[this.currentPage-2],"undefined"!=typeof $?($(n).animate({top:t},1e3*this.pageScrollInterval),$(a).animate({top:0},1e3*this.pageScrollInterval)):(n.style.top=t+"px",a.style.top="0px")),this.domAnimation(n,"top"),this.domAnimation(a,"top");var o=this;setTimeout(function(){"down"===e?o.currentPage+=1:"up"===e&&(o.currentPage-=1),1===o.currentPage&&(o.worksLinkActive=!1),o.changeArrow(),o.scrollDone=!0,"down"===e&&o.lazyLoadImages("caption.p2",!0),m.redraw()},1e3*this.pageScrollInterval)}},domAnimation:function(e,t,i){2===arguments.length?"string"==typeof arguments[1]?(t=arguments[1],i=this.pageScrollInterval):"number"==typeof arguments[1]&&(i=arguments[1],t="all"):1===arguments.length&&(t="all",i=this.pageScrollInterval),(!this.browser||"IE"===this.browser.name&&this.browser.version>9)&&(e.style.transition=t+" "+i+"s",e.style["-moz-transition"]=t+" "+i+"s",e.style["-webkit-transition"]=t+" "+i+"s",e.style["-o-transition"]=t+" "+i+"s")},lazyLoadImages:function(e,t){var i=document.querySelectorAll(e+" img[data-url]"),a=this,o=[];if(i.length>0){var r=[],s=m.deferred();[].slice.call(i,0,i.length).forEach(function(e){var i=e.getAttribute("data-url"),l=n[i];return o.push(s.promise),"undefined"==typeof l||l||-1!==r.indexOf(i,0)?void s.resolve():(a.loadImg(i,s,t),void r.push(i))})}return o},loadImg:function(e,t,i){var a=new Image,o=this;a.src=e,a.onload=function(){n[e]=!0,i&&setTimeout(m.redraw,1e3*o.pageScrollInterval),t.resolve()},a.onerror=function(){console.log("Image url("+e+") load error!"),t.reject()}},preImgControl:function(e){this.currentImg=e||0,m.redraw(!0)},popImageDetail:function(e,t,i){if(t){i?(this.preImgControl(e),m.sync(this.lazyLoadImages(".img-detail",!0))):this.aboutLinkActive=!0,this.paramControl(!0),m.redraw(!0)}},paramControl:function(e){var t=document.querySelector(".diext .img-detail");e?(t.style.zIndex="766","undefined"!=typeof $?$(t).animate({opacity:1},1e3*this.pageScrollInterval):t.style.opacity=1,this.domAnimation(t,"opacity"),setTimeout(function(){t.scrollTop=0},10*this.pageScrollInterval)):(t.style.opacity=0,t.style.zIndex="744"),this.showArrowDown=!e,this.showArrowUp=!e,this.showDeleteIcon=e,this.showLinkIcon=e,this.seeImgDetail=e,e||this.changeArrow()},backToMain:function(){this.deleteImageDetail(),this.previousPage()},imageScale:function(e,t,i,n){if(i&&n){var a=1.01,o=1,r=1;t?(a=1.2,o=1.2,r=1.2,e.style.zIndex=999):e.style.zIndex="inherit",e.style.transform="scale("+a+","+o+")",e.style["-moz-transform"]="scale("+a+","+o+")",e.style["-webkit-transform"]="scale("+a+","+o+")",e.style["-o-transform"]="scale("+a+","+o+")",this.domAnimation(e,1.5)}},bindScaleEvent:function(e,t,i){if(!t.bindEvent){var n=this;t.bindEvent=!0,t.onmouseover=function(){n.imageScale.call(n,this,!0,!!e,i)},t.onmouseout=function(){n.imageScale.call(n,this,!1,!!e,i)}}}},controller:function(){var e=a.viewModel;return e.init(),e},imageView:function(e,t,i,a){var o="./images/balckline.jpg",r=!0,s={};return t&&n[t]&&(o=t,r=!1),s.src=o,t&&r&&(s["data-url"]=t),s.config=function(i){var n=i.parentNode;r||2===e.currentPage&&("undefined"!=typeof $&&$(i).animate({opacity:1},1e3*e.pageScrollInterval),setTimeout(function(){var o=n.querySelector(".loading");o&&(o.style.display="none"),i.style.opacity=1,e.bindScaleEvent.call(e,t,i,a)},1e3*e.pageScrollInterval),e.domAnimation(i,"opacity"))},m("div.img"+(r?".default":""),i,[m("span.loading","Loading"),m("img",s)])},view:function(e){var t=e.seeImgDetail||2===e.currentPage;return[m("header"+(t?".white-bg":""),{config:function(i){t&&e.adjustHeaderWidth.call(e,i)}},[m("div.left",[m("span.logo",{onclick:e.backToMain.bind(e)}),m("span.txt",{onclick:e.backToMain.bind(e)},"DIEXT LAB")]),m("div.right",m("nav",[m("a"+(e.worksLinkActive&&e.scrollDone?".active":""),{onclick:function(){e.worksLinkActive=!0,e.nextPage.call(e)}},"WORKS"),m("a"+(e.aboutLinkActive?".active":""),{onclick:e.popImageDetail.bind(e,null,!0,!1)},"ABOUT")])),e.showArrowDown?m("div.scrollDown",{onclick:e.previousPage.bind(e)},m("span.icon")):"",e.showDeleteIcon?m("div.deleteIcon",{onclick:e.deleteImageDetail.bind(e)},m("span.icon")):"","",m("div.clear")]),m("caption.p1",m("div.main",{onmousemove:function(e){var t=this.querySelector(".card"),i=-((window.innerWidth/2-e.pageX)/20),n=(window.innerHeight/2-e.pageY)/10;t.setAttribute("style","transform:rotateY("+i+"deg) rotateX("+n+"deg);-webkit-transform: rotateY("+i+"deg) rotateX("+n+"deg);-moz-transform: rotateY("+i+"deg) rotateX("+n+"deg)")}},m("div.card",[m("img.frame",{src:"./images/bigword.svg"}),m("img.john",{src:"./images/lines.svg"}),m("img.lower",{src:"./images/smallword.svg"})]))),m("caption.p2",e.p2Images.map(function(t,i){return m("div.row",t.map(function(n,o){return a.imageView(e,n,{onclick:e.popImageDetail.bind(e,i*t.length+o,!!n,!0),height:"438",width:"640",scale:"0.333333"},!0)}))})),m("div.img-detail",e.aboutLinkActive?m("div.main.about",[m("h3","About DIEXT"),m("p.desc","DIEXT是一家互联网设计公司，创新与创意是DIEXT设计最核心的竞争力。同时在用户体验方面积累了多年的经验，为客户打造充满美而惊喜的产品体验与服务。我们的业务范围以界面为源点，衍生出用户体验设计、UI视觉设计、营销设计等，覆盖在流行的各种平台"),m("p.contact",[m("span","合作或咨询，请发邮件至  "),m("a",{href:"mailto:diecxters@foxmail.com"},m("strong","diecxters@foxmail.com"))])]):m("div.main",e.p3Images[e.currentImg].map(function(t){return a.imageView(e,t,{height:e.sizeImages[t].height,width:e.sizeImages[t].width||"1080",scale:"0.5"},!1)}))),m("footer",[e.showArrowUp?m("div.scrollUp",{onclick:e.nextPage.bind(e)},m("span.icon")):""])]}},o={isInitialized:!1,init:function(){var e={},t=null;tool.addEvent(window,"scroll",function(){var i=document.querySelector("body").scrollTop,a=window.innerHeight,o=document.querySelectorAll(".diext-m img[data-url]");[].slice.call(o,0,o.length).forEach(function(o){var r=o.getAttribute("data-url");if(!e[r]&&!n[r]){var s=o.parentNode,l=s.offsetTop;i+a>l+50&&(e[r]=!0,t=new Image,t.src=r,t.onload=function(){n[r]=!0,s.querySelector(".loading").style.display="none",m.redraw(),console.log(r+"loaded")},t.onerror=function(){console.log("Image url("+r+") load error!")})}})})},viewModel:{p2Images:t,backToMain:function(){location.hash="main"}},controller:function(){return o.isInitialized||o.init(),o.viewModel},view:function(e){return[m("div#main.main",[m("header",[m("div.left",m("span.text","DIEXT LAB")),m("nav.right",[m("a",{href:"#thumb"},"WORKS"),m("a","ABOUT")]),m("di.clear")]),m("div.content",m("div.imgs",[m("img.target",{src:"./images/target.png"}),m("img.desc",{src:"./images/desc.png"})]))]),m("div#thumb.thumb",[m("div.title",{onclick:e.backToMain.bind(e)},"WORKS"),m("div.content",e.p2Images.map(function(e){return e.map(function(e){var t="./images/balckline.jpg",i=!0,a={};return e&&n[e]&&(t=e,i=!1),a.src=t,e&&i&&(a["data-url"]=e),m("div.img"+(i?".default":""),[i?m("span.loading","Loading"):"",m("img",a)])})}))])]}};e(),tool.addEvent(window,"resize",function(){e()})}();